---
title: "Building Models for Stratigraphic Paleobiology in R"
autor: "Niklas Hohmann, Xianyi Liu, Emilia Jarochowska"
format: 
  revealjs:
    embed-resources: true
---

## Stratigraphic Paleobiology



## Age-depth models (ADMs)

```{r}
library("admtools")
library("StratPal")
pos = "2km"  # distance from shore
adm_2km = tp_to_adm(t = scenarioA$t_myr,        # construct ADM
                     h = scenarioA$h_m[,pos],
                     T_unit = "Myr",
                     L_unit = "m")
plot(adm_2km,
     lwd_acc = 4,   # plot thicker lines for intervals with sediment accumulation (lwd = line width)
     lty_destr = 0) # don't plot destructive intervals/gaps (lty = line type)
T_axis_lab()        # add time axis label
L_axis_lab()        # add length axis label
title("Age-depth model")

```


## Piping


```{r}
#| echo: true
1 + 1
```

## Example data

![](..figs/scenarioA_transect.jpg)

:::aside
Hohmann et al. 2024: Identifying the mode of evolution in incomplete carbonate successions
:::


## Example data

![](../figs/scenarioA_chronostrat.jpg)

:::aside
Hohmann et al. 2024: Identifying the mode of evolution in incomplete carbonate successions
:::

## Tasks ADMs and incompleteness (45 min)

1. Define age-depth models for different locations along the onshore-offshore gradient, and plot them.  
How do they connect to the chronostratigraphic diagram and the sea level curve shown in the introduction?
2. Examine how stratigraphic incompleteness and the number of hiatuses changes along the onshore-offshore gradient.
3. Generate histograms of hiatus durations at the different distances from shore.  
Do you see any systematic changes?

## Break (15 min)

## Tasks trait evolution (45 min)

1.  Plot the different modes of evolution in the time domain.  
What is their internal variation due to randomness (i.e., how much do results differ if you plot them multiple times), and which modes can be mistaken for each other?
2.  Transform the different modes of evolution into the stratigraphic domain and plot them.  
Which modes are most affected by stratigraphic biases? Which are not affected? Do you see any systematic biases along the onshore/offshore gradient or with stratigraphic (in)completeness?

## Break (15 min)

## Tasks data (45 min)

### Niche modeling

1.  Simulate an abundant taxon, and transform the fossil ages into the stratigraphic domain. At which locations and stratigraphic heights do you observe peaks in fossil abundance? With which stratigraphic effects are these peaks associated?
2.  Define a niche for a taxon, and add the niche model to your pipeline. How and why do your results change? How could you misinterpret the results?

### Tasks last occurrences

1.  Simulate last occurrences based on the assumption of a constant rate of last occurrences  and transform them into the stratigraphic domain. Where do you observe clusters of last occurrences? With what stratigraphic effects are these locations associated? How would you misinterpret the results in the absence of stratigraphic information? Use your results to formulate a "stratigraphic null hypothesis" for clusters of last occurrences.

## Advanced usage

* Other forward models
* Other biological models (niches, trait evolution)

